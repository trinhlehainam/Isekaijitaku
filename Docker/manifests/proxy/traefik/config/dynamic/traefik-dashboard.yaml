# https://doc.traefik.io/traefik/operations/dashboard/#dashboard-router-rule

http:
  routers:
    traefik-dashboard-local-router:
      rule: Host(`traefik.yourdomain.local`)
      # service: traefik-dashboard-local-service
      service: api@internal
      entryPoints:
        - "websecure"
      tls:
        certResolver: stepca
      middlewares:
        # - oauth2-errors@file
        - oauth2@file
        - oauth2-admin@file

    traefik-dashboard-router:
      rule: Host(`traefik.yourdomain.local`)
      service: api@internal
      entryPoints:
        - "websecure"
      tls:
        certResolver: cloudflare
      middlewares:
        # - oauth2-errors@file
        - oauth2@file
        - oauth2-admin@file

  # services:
  #   # NOTE: avoid port forwarding from host machine by using container network
  #   # need to enable insecure Mode to tell Traefik expose dashboard on port 8080
  #   # https://doc.traefik.io/traefik/operations/dashboard/#insecure-mode
  #   traefik-dashboard-local-service:
  #     loadBalancer:
  #       servers:
  #         - url: "http://traefik:8080"
