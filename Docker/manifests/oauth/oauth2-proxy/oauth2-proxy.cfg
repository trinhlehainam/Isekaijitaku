# https://oauth2-proxy.github.io/oauth2-proxy/configuration/providers/keycloak_oidc
# https://github.com/oauth2-proxy/oauth2-proxy/blob/master/contrib/local-environment/oauth2-proxy-keycloak.cfg
# https://github.com/oauth2-proxy/oauth2-proxy/blob/master/contrib/local-environment/traefik/dynamic.yaml
# https://lf-onap.atlassian.net/wiki/spaces/DW/pages/16517544/Oauth2-Proxy+implementation+and+configuration

http_address="0.0.0.0:4180"
cookie_secret="$OAUTH2_PROXY_COOKIE_SECRET"
email_domains="*"
cookie_secure="true"
cookie_domains=[".yourdomain.local"] # Required so cookie can be read on all subdomains.
whitelist_domains=[".yourdomain.local"] # Required to allow redirection back to original requested target.

# Proxy and upstream configuration
reverse_proxy="true"
upstreams="static://202"
# The following option skip the page requesting the user
# to click on a button to be redirected to the identity provider
# It can be activated only when traefik is not configure with
# the error redirection middleware as this example.
skip_provider_button="true"

# Keycloak provider configuration
client_secret="$OAUTH2_PROXY_CLIENT_SECRET"
client_id="$OAUTH2_PROXY_CLIENT_ID"
redirect_url="http://oauth2-proxy:4180/oauth2/callback"

# OIDC configuration
oidc_issuer_url="$OAUTH2_PROXY_OIDC_ISSUER_URL"
provider="keycloak-oidc"
provider_display_name="Keycloak"
provider_ca_files="/etc/ssl/step-ca/root_ca.crt"
code_challenge_method="S256"

# Authorization configuration
pass_user_headers="true"
# pass_access_token="true"
# pass_authorization_header="true"
# set_authorization_header="true"

# Logging configuration
standard_logging="true"
standard_logging_format="text"
request_logging="true"