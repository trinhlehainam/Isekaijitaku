# https://github.com/CorentinTh/it-tools?tab=readme-ov-file#self-host

services:
  it-tools:
    container_name: it-tools
    # https://hub.docker.com/r/corentinth/it-tools/tags
    image: 'corentinth/it-tools:2024.10.22-7ca5933'
    restart: unless-stopped
{% if not use_traefik|default(false) %}
    ports:
      - 8080:80
{% endif %}
{% if use_traefik|default(false) %}
    networks:
      - proxy
    labels:
      - "traefik.enable=true"
      - 'traefik.docker.network=proxy'
      - 'traefik.http.services.it-tools.loadbalancer.server.port=80'
  {% if traefik_router_private|default(false) and traefik_private_root_domain|default(false) %}
      ## Private
      - "traefik.http.routers.it-tools-local.rule=Host(`{{ service_name|default('it-tools') }}.{{ private_apex_domain }}`)"
      - "traefik.http.routers.it-tools-local.entrypoints=websecure"
      - "traefik.http.routers.it-tools-local.tls.certresolver=stepca"
      - "traefik.http.routers.it-tools-local.middlewares=oauth2-admin@file"
  {% endif %}
  {% if traefik_router_public|default(false) and traefik_public_root_domain|default(false) %}
      ## Public
      - "traefik.http.routers.it-tools.rule=Host(`{{ service_name|default('it-tools') }}.{{ public_apex_domain }}`)"
      - "traefik.http.routers.it-tools.entrypoints=websecure"
      - "traefik.http.routers.it-tools.tls.certresolver=cloudflare"
      - "traefik.http.routers.it-tools.middlewares=oauth2-admin@file"
  {% endif %}

networks:
  proxy:
    external: true
{% endif %}
